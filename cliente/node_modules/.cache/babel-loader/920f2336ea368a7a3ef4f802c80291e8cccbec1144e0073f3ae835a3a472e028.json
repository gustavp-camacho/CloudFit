{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Windows 11\\\\Desktop\\\\CloudFit\\\\cliente\\\\src\\\\pages\\\\login.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './login.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Login = () => {\n  _s();\n  const navigate = useNavigate();\n  const [formData, setFormData] = useState({\n    email: '',\n    password: ''\n  });\n  const [error, setError] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const handleChange = e => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setIsLoading(true);\n    setError('');\n    try {\n      console.log('Intentando login con:', formData);\n      const response = await fetch('http://18.219.156.200:5000/api/auth/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(formData)\n      });\n      const data = await response.json();\n      console.log('Respuesta completa del servidor:', data); // Ver toda la respuesta\n\n      if (response.ok) {\n        var _data$user, _data$user2, _data$user3;\n        // Guardar el token\n        localStorage.setItem('token', data.token);\n\n        // Guardar los datos del usuario\n        const userData = {\n          username: data.username || ((_data$user = data.user) === null || _data$user === void 0 ? void 0 : _data$user.username) || formData.email,\n          // Intentar obtener username o usar email como fallback\n          email: data.email || ((_data$user2 = data.user) === null || _data$user2 === void 0 ? void 0 : _data$user2.email),\n          // añade otros campos que necesites\n          role: data.role || ((_data$user3 = data.user) === null || _data$user3 === void 0 ? void 0 : _data$user3.role) // Asegúrate de que el backend envíe el rol\n        };\n        localStorage.setItem('user', JSON.stringify(userData));\n\n        // Verificar qué se guardó\n        console.log('Datos guardados en localStorage:', {\n          token: localStorage.getItem('token'),\n          user: JSON.parse(localStorage.getItem('user'))\n        });\n\n        // Redirección basada en el rol\n        if (userData.role === 'admin') {\n          navigate('/Admin');\n        } else if (userData.role === 'user') {\n          navigate('/menu');\n        } else {\n          // Ruta por defecto si no hay rol específico\n          navigate('/menu');\n        }\n      } else {\n        setError(data.message || 'Error en la autenticación');\n      }\n    } catch (err) {\n      console.error('Error detallado:', err);\n      setError('Error de conexión con el servidor. Asegúrate de que el servidor esté activo.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"login-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"user-icon\",\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"cloudfit_l.png\",\n        alt: \"Icono Usuario\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 15\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"\\xA1Empieza en la nube!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"login-form\",\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"email\",\n        children: \"Correo Electr\\xF3nico\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"email\",\n        id: \"email\",\n        name: \"email\",\n        placeholder: \"Correo Electr\\xF3nico\",\n        value: formData.email,\n        onChange: handleChange,\n        disabled: isLoading,\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"password\",\n        children: \"Contrase\\xF1a\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        id: \"password\",\n        name: \"password\",\n        placeholder: \"Contrase\\xF1a\",\n        value: formData.password,\n        onChange: handleChange,\n        disabled: isLoading,\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-message\",\n        role: \"alert\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"create-account\",\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/signup\",\n          children: \"CREAR CUENTA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"login-btn\",\n        disabled: isLoading,\n        children: isLoading ? 'Iniciando sesión...' : 'Iniciar Sesión'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n};\n_s(Login, \"3JR7YYzfsSVJjwnKL4Co7Hx9ymk=\", false, function () {\n  return [useNavigate];\n});\n_c = Login;\nexport default Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","useState","useNavigate","jsxDEV","_jsxDEV","Login","_s","navigate","formData","setFormData","email","password","error","setError","isLoading","setIsLoading","handleChange","e","target","name","value","handleSubmit","preventDefault","console","log","response","fetch","method","headers","body","JSON","stringify","data","json","ok","_data$user","_data$user2","_data$user3","localStorage","setItem","token","userData","username","user","role","getItem","parse","message","err","className","children","src","alt","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","htmlFor","type","id","placeholder","onChange","disabled","required","href","_c","$RefreshReg$"],"sources":["C:/Users/Windows 11/Desktop/CloudFit/cliente/src/pages/login.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './login.css';\r\n\r\nconst Login = () => {\r\n  const navigate = useNavigate();\r\n  const [formData, setFormData] = useState({\r\n    email: '',\r\n    password: ''\r\n  });\r\n  const [error, setError] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const handleChange = (e) => {\r\n    setFormData({\r\n      ...formData,\r\n      [e.target.name]: e.target.value\r\n    });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    setIsLoading(true);\r\n    setError('');\r\n\r\n    try {\r\n        console.log('Intentando login con:', formData);\r\n\r\n        const response = await fetch('http://18.219.156.200:5000/api/auth/login', {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify(formData)\r\n        });\r\n\r\n        const data = await response.json();\r\n        console.log('Respuesta completa del servidor:', data); // Ver toda la respuesta\r\n\r\n        if (response.ok) {\r\n            // Guardar el token\r\n            localStorage.setItem('token', data.token);\r\n\r\n            \r\n            \r\n            // Guardar los datos del usuario\r\n            const userData = {\r\n                username: data.username || data.user?.username || formData.email, // Intentar obtener username o usar email como fallback\r\n                email: data.email || data.user?.email,\r\n                // añade otros campos que necesites\r\n                role: data.role || data.user?.role, // Asegúrate de que el backend envíe el rol\r\n            };\r\n            \r\n            localStorage.setItem('user', JSON.stringify(userData));\r\n            \r\n            \r\n            // Verificar qué se guardó\r\n            console.log('Datos guardados en localStorage:', {\r\n                token: localStorage.getItem('token'),\r\n                user: JSON.parse(localStorage.getItem('user'))\r\n            });\r\n            \r\n            // Redirección basada en el rol\r\n        if (userData.role === 'admin') {\r\n          navigate('/Admin');\r\n        } else if (userData.role === 'user') {\r\n          navigate('/menu');\r\n        } else {\r\n          // Ruta por defecto si no hay rol específico\r\n          navigate('/menu');\r\n        \r\n        }\r\n            \r\n        } else {\r\n            setError(data.message || 'Error en la autenticación');\r\n        }\r\n    } catch (err) {\r\n        console.error('Error detallado:', err);\r\n        setError('Error de conexión con el servidor. Asegúrate de que el servidor esté activo.');\r\n    } finally {\r\n        setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"login-container\">\r\n      <div className=\"user-icon\">\r\n              <img src=\"cloudfit_l.png\" alt=\"Icono Usuario\" />\r\n            </div>\r\n      <p>¡Empieza en la nube!</p>\r\n      \r\n      <form className=\"login-form\" onSubmit={handleSubmit}>\r\n        <label htmlFor=\"email\">Correo Electrónico</label>\r\n        <input\r\n          type=\"email\"\r\n          id=\"email\"\r\n          name=\"email\"\r\n          placeholder=\"Correo Electrónico\"\r\n          value={formData.email}\r\n          onChange={handleChange}\r\n          disabled={isLoading}\r\n          required\r\n        />\r\n\r\n        <label htmlFor=\"password\">Contraseña</label>\r\n        <input\r\n          type=\"password\"\r\n          id=\"password\"\r\n          name=\"password\"\r\n          placeholder=\"Contraseña\"\r\n          value={formData.password}\r\n          onChange={handleChange}\r\n          disabled={isLoading}\r\n          required\r\n        />\r\n\r\n        {error && (\r\n          <div className=\"error-message\" role=\"alert\">\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"create-account\">\r\n          <a href=\"/signup\">CREAR CUENTA</a>\r\n        </div>\r\n\r\n        <button \r\n          type=\"submit\" \r\n          className=\"login-btn\"\r\n          disabled={isLoading}\r\n        >\r\n          {isLoading ? 'Iniciando sesión...' : 'Iniciar Sesión'}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}